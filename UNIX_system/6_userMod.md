### <span style="color:skyblue">주요 용어</span>

```
* 사용자 계정
  - 시스템의 사용을 위해 부여된 아이디이며 특정 그룹의 구성원이다.

* 관리자 계정
  - 관리자 권한을 가지는 root 계정.
  - root 계정은 다른 사용자의 파일을 수정 또는 삭제할 수 있으며 일반 사용자에게 허용되지 않는 관리자 명령을 수행할 수 있다.

* 홈 디렉터리
  - 사용자가 로그인했을 때 위치하는 기본 작업 디렉터리

* 패스워드 에이징
  - /etc/shadow 파일에서 설정된 정보 중에서 비밀번호 변경 후 바꿀 수 없는 기간, 비빌번호 변경 후 다시 변경하지 않고 사용할 수 있는 최대 기간,
    사용자 계정의 만료일 등 비밀번호 만료에 관한 방법을 의미한다.
```

### 🔸 사용자 계정

- 사용자는 사용자 계정에 의해 구분되는데 반드시 어떤 그룹에 속함
- 계정의 분류
  - 루트 계정은 시스템 관리자 계정으로 모든 권한을 가짐
  - 일반 사용자로 분류되는 계정이 있음
  - 로그인이 불가능하며 시스템의 필요에 의해 생성된 시스템 계정도 있음

### 🔸 슈퍼 유저(root)

- root 계정은 시스템 관리자 계정으로 모든 권한을 가짐

### 🔸 사용자 전환 명령 : su

- su 명령은 root 또는 다른 사용자 계저으이 권한으로 전환하기 위한 명령이며 해당 계정의 패스워드가 필요
- 사용법 : `su [-[l]] [사용자계정]`
  - su (root 계정으로 전환하며 root 암호를 알아야 함)
- 사용 예
  - su -l user1 (user1 계정으로 로그인하며 root가 아니라면 해당 계정의 암호를 알아야 함)
  - su -c 명령
    - 일회성으로 1개의 셸 명령을 root 계정의 자격으로 실행
    - 명령이 여러 단어로 되어 있으며 따옴표로 묶어야 함
    - 새로운 셸에서 수행

### 🔸 관리자 권한으로 실행 : sudo

- 사용법 : sudo 명령
  - 명령을 표현할 때 인용부호를 사용할 필요가 없음
  - 새로운 셸이 아닌 현재 셸에서 수행됨
- 관리자가 sudo를 실행할 수 있는 사용자를 <span style="color:yellow">/etc/sudoers</span> 파일에 기록해 두어야 함
- /etc/sudoers
  - visudo를 사용해 편집하면 문법 오류를 검사해 줌
  - sudoers 파일의 형식은 라인별로 사용자 허용된호스트=허용된명령의 형태
- 사용 예
  - sudo touch /mnt/test.txt (일반 사용자 계정으로는 파일을 생성할 수 없는 /mnt 디렉터리에서 root 권한으로 test.txt 만들 수 있음)

### 🔸 /etc/passwd 파일

- 사용자 계정 정보를 가진 텍스트 파일
- 라인별로 `사용자계정:패스워드:UID:GID:설명:홈디렉터리:셸의 종류`를 지정함
  - ex) user1:x:501:501:/home/user1:/bin/bash
- 필드의 의미
  - 사용자 계정 : 사용자의 고유한 계정
  - 패스워드 : 패스워가 있음을 x로 표시
  - UID(user id) : 사용자 계정 아이디로 시스템에서는 UID로 사용자를 구분
  - GID(group id) : 사용자가 속한 그룹의 아이디로 그룹에 따라 부여된 권한이 다름
  - 설명 : 사용자 계정에 관한 정보
  - 홈 디렉터리 : 사용자 계정의 기본 디렉터리
  - 셸의 종류 : 로그인 시 활성화되는 셸의 종류

### 🔸 사용자 계정 추가 명령 : useradd

- 사용 법 : `useradd [옵션] 사용자계정`
  - /home/사용자계정 디렉터리와 기본 파일들이 생성됨
  - 사용자 메일박스로 /var/spool/mail/사용자계정 파일이 생성됨
- 패스워드 변경 명령 : `passwd [사용자계정]`

### 🔸 useradd 명령이 참조하는 파일들

- /etc/passwd : 사용자 계정의 자세한 정보
- /etc/shadow : 암호화된 패스워드
- /etc/skel : 사용자 홈 디렉터리에 복사되는 파일들의 템플릿을 가진 디렉터리
  - .bash_profile, .bashrc, .bash_logout : 로그인 셸 또는 일반 셸이 시작될 때 실행되는 스크립트
- /etc/group : 그룹 정보, 그룹명과 GID 나열
- /etc/login.defs : 사용자 계정 추가 시 적용되는 설정
- /etc/default/useradd : 홈 디렉터리, 셸의 종류 등 정보
  - 홈 디렉터리 생성 위치 : /home
  - 셸의 종류 : /bin/bash, /bin/csh, /bin/ksh

### 🔸 /etc/login.defs 파일

- 각 라인은 키워드와 값으로 구성되며 둘 사이는 화이트 스페이스 문자로 구분
- 주요 키워드의 의미
  - MAIL_DIR : 메일 스풀 디렉터리 지정
  - PASS_MAX_DAYS : 비밀번호를 변경하지 않고 사용할 수 있는 최대 기간
  - PASS_MIN_DAYS : 비밀번호 변경 후 바꿀 수 없는 기간
  - PASS_MIN_LEN : 비밀번호의 최소 길이
  - CREATE_HOME : 홈 디렉터리 자동 생성 여부
  - UMASK : 파일 접근권한의 기본값

### 🔸 사용자 계정 삭제 : userdel

- 사용자 계정의 삭제는 바람직하지 않음
  - 디렉터리가 삭제되지 않은 상태에서 새로운 사용자가 기존의 UID를 할당받을 수 있으므로
- 사용자를 삭제하지 않고 로그인을 막는 방법
  - /etc/shadow 파일에서 암호 부분에 \*와 같은 문자를 삽입
  - `usermod -L 사용자계정` (계정을 잠금)
- 사용법 : `userdel [옵션] 사용자 계정`
  - 옵션 -r : 계정 삭제와 동시에 홈 디렉터리와 홈 디렉터리의 파일들, 메일 파일도 삭제

### 🔸 사용자 계정의 정보 변경 : usermod

- 사용자가 속해 있는 그룹을 변경하거나 홈 디렉터리를 변경
- 사용법 : `usermod [옵션] 사용자계정`
- 옵션의 설명
  - -e YYYY-MM-DD : 계정 사용 만료일 지정
  - -g GROUP : 사용자의 소속 그룹을 변경
  - -s SHELL : 로그인 셸을 변경

### 🔸 그룹

- 사용자의 계정들을 모아서 하나의 집합을 이루는 개념
  - 그룹에 속한 사용자는 그룹에 부여된 권한을 가짐
  - bin, mail, sys 등의 시스템 정의 그룹에는 포함될 수 없음
  - 같은 그룹 내 사용자의 파일 접근권한과 다른 그룹 사용자의 파일 접근권한을 다르게 적용
- 그룹 계정
  - 그룹별로 할당된 권한, 그룹에 속한 계정에 영향을 줄 수 있음
- 관련 파일
  - /etc/group, /etc/gshadow 등

### 🔸 새로운 그룹 생성 명령 : groupadd

- 사용법 : `groupadd [옵션] 그룹명`
- 옵션 -g GID : 그룹의 ID를 GID로 지정. 기존 GID와 중복되지 않아야 함
- ex)
  - groupadd staff (지정된 그룹을 생성)
  - groupadd -g 510 foo (지정된 그룹의 GID를 변경)
  - groups [사용자계정] (사용자가 속한 그룹의 확인 명령)

### 🔸 그룹 삭제 명령 : groupdel

- 사용법 : groupdel 그룹명

### 🔸 그룹의 속성 변경 명령 : groupmod

- 사용법 : groupmod [옵션] 그룹명
- ex)
  - groupmod -g 511 foo (그룹 foo의 GID 변경)
  - groupmod -n var foo (그룹 foo의 이름을 var로 변경)
