### 14.1 해시함수

#### 14.1.1 해시함수의 개념

1. 해시함수

- 입력 데이터 스트링을 고정된 길이의 해시코드로 대응시키는 함수로 다음 두 가지 성질을 만족해야 함
  - 주어진 해시코드에 대하여 이 해시코드를 생성하는 데이터 스트링을 찾아내는 것은 계산상 실행 불가능
  - 주어진 데이터 스트링에 대하여 같은 해시코드를 생성하는 또 다른 데이터 스트링을 찾아내는 것도 계산상 실행 불가능

2. 해시함수 역시 일방향 함수임

- 임의의 데이터에 대한 해시코드는 쉽게 생성하지만, 해시코드에 대응되는 데이터를 거꾸로 찾는 것은 어려움

#### 14.1.2 해시함수의 응용 분야

1. 메시지 인증
2. 전자서명
3. 의사 난수 생성기

#### 14.1.3 해시함수의 요구 조건

1. h는 임의의 크기의 입력 D에 적용할 수 있을 것
2. h는 일정한 크기의 출력인 해시코드 H를 낼 것

- 출력 비트의 길이는 최소한 128비트 이상이어야 함
- 이는 생일공격(birthday attack), 중간자 공격(meet in the middle attack)에 대응하기 위함임

3. h와 D가 주어졌을 때, H = h(D)를 계산하기 쉬울 것
4. h는 H가 주어졌을 때, H = h(D)를 만족하는 D를 구하는 것이 계산상 실행 불가능할 것

- 약한 일방향성

5. h와 D가 주어졌을 때, h(D) = h(D')을 만족하는 다른 데이터 스트링 D'을 구하는 것이 계산상 실행 불가능할 것

- 강한 일방향성

6. h가 주어졌을 때, h(D) = h(D')을 만족하는 데이터 스트링 D와 D'을 구하는 것이 계산상 실행 불가능할 것

- 충돌 저항성

#### 14.1.4 해시 알고리즘

1. 해시 알고리즘의 분류

- 블록 암호 알고리즘에 기초한 해시 알고리즘 : 블록 암호보다 느림
- 전용 해시 알고리즘 : 대부분 응용에서 이용됨
- 모듈러 연산을 이용한 해시 알고리즘 : 속도가 느려 사용 영역에 제한

2. MD4(Message Digest 4)

- 1990년 리베스트(Ron Rivest)가 발표
- 대부분 전용 해시 알고리즘의 기본 모델이 됨
- 128비트의 해시코드 생성

3. MD5

- MD4보다 좀 더 보수적으로 설계
- 128비트의 해시코드 생성
- 현재는 충돌 저항성과 일방향성에 문제가 있음이 알려져서 사용하지 말것을 권고

4. SHA\-1(Secure Hash Algorithm\-1)

- 1995년에 발표
- 미국의 표준 해시 알고리즘으로 공인
- 160비트의 해시코드 생성
- 조금씩 취약성이 드러나고 있음

5. SHA\-2

- 표준 해시 알고리즘에 포함됨
- 해시코드의 크기에 따라 SHA\-224, SHA\-256, SHA\-384, SHA\-512가 있음

---

### 14.2 전자서명

#### 14.2.1 전자서명의 개념

1. 전자서명

- 문서나 메시지를 보낸 사람의 신원이 진짜임을 증명
- 전달된 메시지나 문서의 원래 내용이 변조되지 않았다는 것을 보증

2. 부가적인 이득

- 전자서명이 쉽게 전송될 수 있음
- 전자서명을 쉽게 부인할 수 없음
- 전자서명을 다른 사람이 흉내 낼 수 없음
- 타임스탬프가 자동으로 유지될 수 있음

3. 메시지의 암호화 여부에 상관없이 전자서명 가능

#### 14.2.2 전자서명의 요구 조건

1. 서명은 서명되는 메시지에 의존하는 비트 패턴임
2. 서명은 위조방지와 부인방지를 위한 송신자만의 고유 정보를 사용해야 함
3. 건자서명 생성 및 검증이 비교적 쉬워야 함
4. 전자서명의 위조는 계산적으로 불가해야 함
5. 전자서명의 복사본을 저장소에 손쉽게 보관할 수 있음

#### 14.2.3 전자서명의 동작원리

1. 서명 방법(서명자)

- 메시지 M에 대해 해시함수를 적용하여 해시코드 h를 구함
- 해시코드 h를 공개키 암호 알고리즘으로 암호화, 이때 서명자의 개인키를 사용하여 암호화함
- 그 결과로 나온 암호문 s가 바로 메시지 M에 대한 서명자의 서명이 됨
- 서명 s는 원래의 메시지 M과 함께 전송되거나 저장됨

2. 검증 방법(누구나)

- 메시지 M에 해시함수를 적용하여 해시코드 h를 구함
- 메시지 M에 대한 서명 s를 공개키 암호 알고리즘으로 복호화, 이때 서명자의 공개키를 사용하여 복호화함
- 그 결과로 나온 평문 h'이 미리 구해 둔 해시코드 h와 일치하는지 비교
- 만약 $h=h'$이면 올바른 서명이므로 메시지 M과 서명자를 모두 신뢰
- 만약 $h{\neq}h'$이라면 메시지 M이 변조되었을 수도 있고, 서명 s가 변조되었거나 제3자가 서명한 경우일 수 있음

#### 14.2.4 전자서명 기법의 종류

1. 엘가말(ElGamal) 전자서명 기법 : 이산대수 문제에 기반
2. 슈노어(Schnorr) 전자서명 기법 : 이산대수 문제에 기반
3. 전자서명표준(DSS)

- DSA(Digital Signature Algorithm) : Elgamal과 Schnorr의 기법에 기반
- ECDSA(Elliptic Curve Digital Signature Algorithm)
- RSA 전자서명 알고리즘
